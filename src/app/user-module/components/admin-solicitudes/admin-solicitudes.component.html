<div class="row">
  <div class="col">
    <h3 class="font-playfair mb-3">Solicitudes</h3>
  </div>

</div>
<div class="table-responsive">
  <table class="table">
    <thead class="fondo-dorado bg-gradient text-white border-0 mb-0">
      <tr class="border-0 mb-0">
        <th scope="col">Tipo</th>
        <th scope="col">Nombre</th>
        <th scope="col">Estado</th>
        <th scope="col"></th>

      </tr>
    </thead>
    <!-- HEADER CON FILTROS -->
    <thead class="fondo-dorado bg-gradient text-white border-0 mb-0">
      <tr class="border-0 mt-0">

        <th scope="col">
          <select class="form-select form-select-sm" #filtroTipo="ngModel" ngModel name="filtroTipo">
            <option value="">Todos</option>
            <option value="Compra">Compra</option>
            <option value="Venta">Venta</option>
            <option value="Alquiler">Alquiler</option>
            <option value="Alquiler">General</option>
          </select>
        </th>

        <th scope="col">
          <input class="form-control form-control-sm" type="text" #filtroNombre="ngModel" ngModel name="filtroNombre">
        </th>

        <th scope="col">
          <select class="form-select form-select-sm" #filtroEstado="ngModel" ngModel name="filtroEstado">
            <option value="">Todos</option>
            <option value="Pendiente">Pendiente</option>
            <option value="Resuelto">Resuelto</option>
          </select>
        </th>
        <th></th>

      </tr>
    </thead>
    <!-- BODY DE LA TABLA -->
    <tbody>
      <!--  -->
      <ng-container *ngFor="let solicitud of solicitudes">
        <tr [ngClass]="{'resuelto': solicitud.estado == 'Resuelto'}"
          *ngIf="(
          (solicitud.tipoSolicitud == filtroTipo.value || filtroTipo.value == '')
          &&
          (solicitud.nombres.toLowerCase() + ' ' + solicitud.apellidos.toLowerCase()).includes(filtroNombre.value.toLowerCase())
          &&
          (solicitud.estado == filtroEstado.value || filtroEstado.value == '')
          )">
          <td>{{ solicitud.tipoSolicitud }}</td>
          <td>{{ solicitud.nombres + " " + solicitud.apellidos }}</td>
          <td>{{ solicitud.estado }}</td>
          <td><button (click)="setSolicitudDetalles(solicitud)" class="btn btn-sm btn-info float-end" data-bs-toggle="modal" data-bs-target="#modalDetalles">Detalles</button></td>
        </tr>
      </ng-container>
    </tbody>
  </table>
  </div>



<!-- MODAL DETALLES -->
<div class="modal fade" id="modalDetalles" tabindex="-1" aria-labelledby="modalEditarLabel" aria-hidden="true">
<div class="modal-dialog modal-lg">
  <div *ngIf="solicitudDetalles" class="modal-content">
    <div class="modal-header bg-secondary text-white">
      <h5 class="modal-title" id="exampleModalLabel">Solicitud de {{solicitudDetalles.tipoSolicitud}}</h5>
      <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <div class="container">
        <h3 class="font-playfair">Información de contacto</h3>
        <p>Nombre: {{ solicitudDetalles.nombres + " " + solicitudDetalles.apellidos }} <br>
        Correo: {{ solicitudDetalles.email }} <br>
        Telefono: {{ solicitudDetalles.telefono }} <br>
        <span *ngIf="solicitudDetalles.tipoSolicitud != 'General'">Horario para contactar: {{ solicitudDetalles.horario }} <br>
        Zona donde vive: {{ solicitudDetalles.zonaDondeVive }}</span>
        <span *ngIf="solicitudDetalles.tipoSolicitud == 'General'">
          Servicio en el que está interesado: {{ solicitudDetalles.servicio }} <br>
          Información Adicional: {{ solicitudDetalles.infoAdicional }}
        </span>
      </p>

      <div *ngIf="solicitudDetalles.tipoSolicitud != 'General'">
        <h3 class="font-playfair mt-4">Información sobre la propiedad</h3>
        <table class="table my-3">
          <tbody>
            <tr>
              <th scope="row fw-lighter">Tipo de transacción:</th>
              <td>{{ solicitudDetalles.tipoSolicitud }}</td>
            </tr>
            <tr>
              <th scope="row">{{ solicitudDetalles.tipoSolicitud == 'Venta' ? 'Zona donde se encuentra el inmueble:' : 'Región o zona de interés:' }}</th>
              <td>{{ solicitudDetalles.zonaDelInmueble }}</td>
            </tr>
            <tr>
              <th scope="row">Tipo de inmueble:</th>
              <td>{{ solicitudDetalles.tipoInmueble }}</td>
            </tr>
            <tr>
              <th scope="row">Estado del inmueble:</th>
              <td>{{ solicitudDetalles.estadoInmueble }}</td>
            </tr>
            <tr>
              <th scope="row">Seguridad del inmueble:</th>
              <td>{{ solicitudDetalles.tipoCalle }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">
              <th scope="row">Equipamiento del inmueble:</th>
              <td>{{ solicitudDetalles.equipamiento }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">
              <th scope="row">Piso:</th>
              <td>{{ solicitudDetalles.piso }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Metros cuadrados:</th>
              <td>{{ solicitudDetalles.metrosCuadrados }}</td>
            </tr>
            <tr>
              <th scope="row">Número <span *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">mín.</span> de habitaciones:</th>
              <td>{{ solicitudDetalles.numeroHabitaciones }}</td>
            </tr>
            <tr>
              <th scope="row">Número <span *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">mín.</span> de baños completos:</th>
              <td>{{ solicitudDetalles.numeroBanos }}</td>
            </tr>
            <tr>
              <th scope="row">Número <span *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">mín.</span> de puestos de estacionamiento:</th>
              <td>{{ solicitudDetalles.numeroHabitaciones }}</td>
            </tr>
          </tbody>
        </table>

        <h3 class="font-playfair mt-4">Información sobre la {{solicitudDetalles.tipoSolicitud}}</h3>
        <table class="table my-3">
          <tbody>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Tiene los documentos en regla:</th>
              <td>{{ solicitudDetalles.documentos }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Ha realizado estimación del valor del inmueble:</th>
              <td>{{ solicitudDetalles.estimacion }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Sabe cuanto espera por el inmueble:</th>
              <td>{{ solicitudDetalles.montoInmueble }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">
              <th scope="row">Debe vender para poder comprar:</th>
              <td>{{ solicitudDetalles.debeVender }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">
              <th scope="row">Posee mascota:</th>
              <td>{{ solicitudDetalles.poseeMascota }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Compra' || solicitudDetalles.tipoSolicitud == 'Alquiler'">
              <th scope="row">Tiene firma jurídica:</th>
              <td>{{ solicitudDetalles.firmaJuridica }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Desde cuando está vendiendo:</th>
              <td>{{ solicitudDetalles.fechaDeseoVenta }}</td>
            </tr>
            <tr>
              <th scope="row">{{ solicitudDetalles.tipoSolicitud == 'Venta' ? 'Para cuando quiere vender:' : 'Para cuándo quiere el inmueble:' }}</th>
              <td>{{ solicitudDetalles.fechaDeseoVenta }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Conoce la exclusiva de ventas:</th>
              <td>{{ solicitudDetalles.conoceExclusiva }}</td>
            </tr>
            <tr *ngIf="solicitudDetalles.tipoSolicitud == 'Venta'">
              <th scope="row">Posee asesor:</th>
              <td>{{ solicitudDetalles.poseeAsesor }}</td>
            </tr>
          </tbody>
        </table>


        <h3 class="font-playfair mt-4">Información sobre adicional</h3>
        <table class="table mt-3">
          <tbody>
            <tr>
              <th scope="row">Vía por la que conoció Eagle:</th>
              <td>{{ solicitudDetalles.viaConocimiento }}</td>
            </tr>
            <tr>
              <th scope="row">Información adicional:</th>
              <td>{{ solicitudDetalles.infoAdicional }}</td>
            </tr>
          </tbody>
        </table>
      </div>
      </div>
    </div>
    <div class="modal-footer">
      <button (click)="marcar()" type="button" class="btn btn-primary" data-bs-dismiss="modal">Marcar como {{ solicitudDetalles.estado == 'Pendiente' ? 'resuelto' : "pendiente" }}</button>
      <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
    </div>
  </div>
</div>
</div>

